!function(){"use strict";var e={};function n(e,n,t,r,o,i,c){try{var a=e[i](c),l=a.value}catch(e){return void t(e)}a.done?n(l):Promise.resolve(l).then(r,o)}function t(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var c=e.apply(t,r);function a(e){n(c,o,i,a,l,"next",e)}function l(e){n(c,o,i,a,l,"throw",e)}a(void 0)}))}}function r(){return o.apply(this,arguments)}function o(){return(o=t(regeneratorRuntime.mark((function e(){var n,t,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=document.querySelector("#display-name-display"),t=document.querySelector("#email-display"),r=document.querySelector("#token-display"),o=document.querySelector("#download-link"),c=Office.context.mailbox.userProfile,r.innerHTML="Processing...",Office.context.mailbox.getCallbackTokenAsync((function(e){if(e.status!=Office.AsyncResultStatus.Failed){var a="";t.innerHTML="<b>Email:</b> ".concat(c.emailAddress),a+="Email: ".concat(c.emailAddress,"\n"),n.innerHTML="<b>User:</b> ".concat(c.displayName),a+="User: ".concat(c.displayName,"\n"),r.innerHTML=e.value,a+="Token: ".concat(e.value),o.style.display="flex",o.href=i(a)}else r.innerHTML="Error! Faild reciving EWS token."}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(e){var n=new Blob([e],{type:"text/plain"});return window.URL.createObjectURL(n)}e.d=function(n,t){for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},e.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},Office.onReady((function(e){e.host===Office.HostType.Outlook&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=r)}))}();
//# sourceMappingURL=taskpane.js.map